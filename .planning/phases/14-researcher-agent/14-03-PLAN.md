---
phase: 14-researcher-agent
plan: 03
type: execute
wave: 2
depends_on: ["14-01"]
files_modified: [commands/gsd/research-project.md, get-shit-done/workflows/research-project.md, get-shit-done/references/research-pitfalls.md]
autonomous: true

must_haves:
  truths:
    - "/gsd:research-project spawns parallel gsd-researcher agents"
    - "Each agent handles one research domain (stack, features, architecture, pitfalls)"
    - "Command is thin orchestrator (<200 lines)"
    - "Deprecated files redirect to agent"
  artifacts:
    - path: "commands/gsd/research-project.md"
      provides: "Thin orchestrator for project research"
      min_lines: 100
      contains: "gsd-researcher"
    - path: "get-shit-done/workflows/research-project.md"
      provides: "Deprecation notice"
      contains: "DEPRECATED"
    - path: "get-shit-done/references/research-pitfalls.md"
      provides: "Deprecation notice"
      contains: "DEPRECATED"
  key_links:
    - from: "research-project.md command"
      to: "gsd-researcher agents (parallel)"
      via: "Multiple Task tool spawns"
      pattern: "subagent_type.*gsd-researcher"
---

<objective>
Refactor /gsd:research-project to thin orchestrator that spawns parallel gsd-researcher agents + deprecate remaining files.

Purpose: Reduce main context load, enable parallel research for project domains.
Output: Thin orchestrator command + deprecated workflow and reference files.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Current implementation to refactor:
@commands/gsd/research-project.md
@get-shit-done/workflows/research-project.md
@get-shit-done/references/research-pitfalls.md

# Agent we're delegating to:
@agents/gsd-researcher.md

# Template from 14-02:
@get-shit-done/templates/research-subagent-prompt.md

# Prior summaries:
@.planning/phases/14-researcher-agent/14-01-SUMMARY.md
@.planning/phases/14-researcher-agent/14-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Refactor research-project command to thin orchestrator</name>
  <files>commands/gsd/research-project.md</files>
  <action>
Rewrite `commands/gsd/research-project.md` as a thin orchestrator (~150-180 lines).

**Orchestrator responsibilities (keep in command):**
1. Validate PROJECT.md exists
2. Check for existing .planning/research/ (offer to view/replace/cancel)
3. Analyze PROJECT.md to determine domain
4. Generate research questions for each dimension
5. Spawn 4 parallel gsd-researcher agents (stack, features, architecture, pitfalls)
6. Wait for all agents to complete
7. Create SUMMARY.md (synthesize agent outputs)
8. Commit research to git
9. Offer next steps (/gsd:define-requirements)

**Delegate to agents (via gsd-researcher):**
- Research methodology
- Source hierarchy
- Domain-specific research execution
- Verification checklist
- Individual file content (STACK.md, FEATURES.md, ARCHITECTURE.md, PITFALLS.md)

**Command structure:**

```yaml
---
name: gsd:research-project
description: Research domain ecosystem before creating roadmap
allowed-tools:
  - Read
  - Write
  - Bash
  - Glob
  - Grep
  - Task
---
```

**Process:**
1. validate - Check PROJECT.md exists
2. check_existing - Handle existing research folder
3. analyze_project - Extract domain, stack hints, core value
4. determine_questions - Generate 4 research questions
5. setup_directory - Create .planning/research/
6. spawn_researchers - Spawn 4 gsd-researcher agents in parallel:
   - Stack agent (mode: implementation, question: stack question)
   - Features agent (mode: ecosystem, question: features question)
   - Architecture agent (mode: implementation, question: architecture question)
   - Pitfalls agent (mode: feasibility, question: pitfalls question)
7. write_summary - Synthesize agent outputs into SUMMARY.md
8. git_commit - Commit all research files
9. present_results - Show summary, offer /gsd:define-requirements

**Parallel spawn pattern:**
```
# Spawn all 4 in parallel (single message with multiple Task calls)
Task(subagent_type: "gsd-researcher", prompt: stack context)
Task(subagent_type: "gsd-researcher", prompt: features context)
Task(subagent_type: "gsd-researcher", prompt: architecture context)
Task(subagent_type: "gsd-researcher", prompt: pitfalls context)
```

Each agent writes its own output file (.planning/research/{DOMAIN}.md).
  </action>
  <verify>
- Command file is 150-180 lines
- Spawns 4 parallel gsd-researcher agents
- No research methodology in command (delegated to agents)
- Has validate, analyze, spawn_researchers, write_summary, git_commit steps
  </verify>
  <done>/gsd:research-project refactored to parallel orchestrator</done>
</task>

<task type="auto">
  <name>Task 2: Deprecate workflows/research-project.md</name>
  <files>get-shit-done/workflows/research-project.md</files>
  <action>
Replace `get-shit-done/workflows/research-project.md` with deprecation notice.

**Content:**
```markdown
# DEPRECATED

This workflow has been replaced by the gsd-researcher agent.

**New location:** `~/.claude/agents/gsd-researcher.md`

The `/gsd:research-project` command now spawns parallel gsd-researcher agents directly. Each agent handles one research domain (stack, features, architecture, pitfalls).

**Migration:** No action needed. Commands automatically use the new agents.
```
  </action>
  <verify>File contains deprecation notice pointing to gsd-researcher agent</verify>
  <done>workflows/research-project.md deprecated with redirect to agent</done>
</task>

<task type="auto">
  <name>Task 3: Deprecate references/research-pitfalls.md</name>
  <files>get-shit-done/references/research-pitfalls.md</files>
  <action>
Replace `get-shit-done/references/research-pitfalls.md` with deprecation notice.

**Content:**
```markdown
# DEPRECATED

This reference has been consolidated into the gsd-researcher agent.

**New location:** `~/.claude/agents/gsd-researcher.md`
**Section:** `<verification_patterns>`

All pitfall detection, verification checklists, and red flags are now baked into the gsd-researcher agent.

**Migration:** No action needed. Research agents automatically apply verification patterns.
```
  </action>
  <verify>File contains deprecation notice pointing to gsd-researcher agent verification_patterns section</verify>
  <done>references/research-pitfalls.md deprecated with redirect to agent</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] commands/gsd/research-project.md refactored (150-180 lines)
- [ ] Command spawns 4 parallel gsd-researcher agents
- [ ] No research methodology in command
- [ ] workflows/research-project.md deprecated with redirect
- [ ] references/research-pitfalls.md deprecated with redirect
</verification>

<success_criteria>

- /gsd:research-project is now a thin parallel orchestrator
- Command spawns 4 gsd-researcher agents in parallel
- Main context load significantly reduced
- Workflow and reference files deprecated with agent pointers
- Phase 14 complete - all research expertise consolidated in gsd-researcher
</success_criteria>

<output>
After completion, create `.planning/phases/14-researcher-agent/14-03-SUMMARY.md`
</output>
