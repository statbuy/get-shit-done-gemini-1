---
phase: 14-dedicated-researcher-agent
plan: 03
type: execute
wave: 2
depends_on: ["14-01"]
files_modified: [commands/gsd/research-project.md, get-shit-done/workflows/research-project.md]
autonomous: true

must_haves:
  truths:
    - "/gsd:research-project spawns parallel gsd-researcher agents"
    - "Command is <200 lines (thin orchestrator)"
    - "Workflow file has deprecation notice pointing to agent"
    - "4 parallel agents for stack, features, architecture, pitfalls"
  artifacts:
    - path: "commands/gsd/research-project.md"
      provides: "Thin orchestrator that spawns parallel researcher agents"
      min_lines: 100
      contains: "gsd-researcher"
    - path: "get-shit-done/workflows/research-project.md"
      provides: "Deprecation notice"
      contains: "DEPRECATED"
  key_links:
    - from: "commands/gsd/research-project.md"
      to: "agents/gsd-researcher.md"
      via: "Parallel Task tool spawns"
      pattern: "subagent_type.*gsd-researcher"
---

<objective>
Refactor /gsd:research-project to spawn parallel gsd-researcher agents.

Purpose: Apply thin orchestrator pattern — command handles project analysis and spawns 4 parallel researcher agents (stack, features, architecture, pitfalls). Each agent writes its own file, orchestrator synthesizes SUMMARY.md.

Output: Refactored command (~180 lines), deprecated workflow.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

Files to refactor:
@commands/gsd/research-project.md
@get-shit-done/workflows/research-project.md

Pattern reference:
@commands/gsd/debug.md (thin orchestrator pattern)
@.planning/phases/13-debug-agent/13-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Refactor /gsd:research-project to thin orchestrator</name>
  <files>commands/gsd/research-project.md</files>
  <action>
Rewrite commands/gsd/research-project.md as thin orchestrator:

**Keep in orchestrator:**
- PROJECT.md validation
- Domain analysis from PROJECT.md
- Research question generation
- Spawning 4 parallel researcher agents
- Waiting for all agents to complete
- Synthesizing SUMMARY.md from agent outputs
- Offering next steps

**Delegate to agents (each writes its own file):**
- Stack research → .planning/research/STACK.md
- Features research → .planning/research/FEATURES.md
- Architecture research → .planning/research/ARCHITECTURE.md
- Pitfalls research → .planning/research/PITFALLS.md

**Structure:**
```markdown
---
name: gsd:research-project
description: Research domain ecosystem before creating roadmap
allowed-tools:
  - Read
  - Write
  - Bash
  - Task
---

<objective>
Research domain ecosystem. Spawns 4 parallel gsd-researcher agents for comprehensive coverage.
</objective>

<process>
1. Validate PROJECT.md exists
2. Analyze project to determine domain
3. Generate research questions (stack, features, architecture, pitfalls)
4. Create .planning/research/ directory
5. Spawn 4 gsd-researcher agents in parallel (each writes its own file)
6. Wait for all to complete
7. Synthesize SUMMARY.md from agent outputs
8. Commit research
9. Offer next steps
</process>

<spawn_agents>
Spawn all 4 in parallel with single message containing multiple Task calls:

Task(prompt="Research stack for {domain}...", subagent_type="gsd-researcher")
Task(prompt="Research features for {domain}...", subagent_type="gsd-researcher")
Task(prompt="Research architecture for {domain}...", subagent_type="gsd-researcher")
Task(prompt="Research pitfalls for {domain}...", subagent_type="gsd-researcher")
</spawn_agents>
```

Target: ~180 lines (down from ~138 lines command + ~430 lines workflow)
  </action>
  <verify>
```bash
wc -l commands/gsd/research-project.md
grep -c "gsd-researcher\|Task\|parallel" commands/gsd/research-project.md
```
Expected: <200 lines, 4+ spawning references
  </verify>
  <done>commands/gsd/research-project.md is thin orchestrator <200 lines, spawns 4 parallel agents</done>
</task>

<task type="auto">
  <name>Task 2: Deprecate workflows/research-project.md</name>
  <files>get-shit-done/workflows/research-project.md</files>
  <action>
Replace workflows/research-project.md with deprecation notice:

```markdown
# Research Project Workflow

## ⚠️ DEPRECATED

**This workflow has been consolidated into the gsd-researcher agent.**

The research methodology for project research now lives in:
- `agents/gsd-researcher.md`

The `/gsd:research-project` command spawns 4 parallel gsd-researcher agents:
- Stack agent → .planning/research/STACK.md
- Features agent → .planning/research/FEATURES.md
- Architecture agent → .planning/research/ARCHITECTURE.md
- Pitfalls agent → .planning/research/PITFALLS.md

The orchestrator synthesizes SUMMARY.md after all agents complete.

**Migration:** No action needed — the command handles this automatically.

---

*Deprecated: 2026-01-XX*
*Replaced by: agents/gsd-researcher.md*
```

Keep file for git history.
  </action>
  <verify>
```bash
head -25 get-shit-done/workflows/research-project.md
```
Should show DEPRECATED notice
  </verify>
  <done>workflows/research-project.md has deprecation notice pointing to agent</done>
</task>

<task type="auto">
  <name>Task 3: Deprecate research-pitfalls.md reference</name>
  <files>get-shit-done/references/research-pitfalls.md</files>
  <action>
Add deprecation notice to top of research-pitfalls.md (keeping content for reference):

```markdown
# Research Pitfalls Reference

## ⚠️ DEPRECATED

**This reference has been consolidated into the gsd-researcher agent.**

The verification protocols and pitfall patterns now live in:
- `agents/gsd-researcher.md` (section: `<verification_protocol>`)

The content below is preserved for reference but is no longer the primary source.

---

*Deprecated: 2026-01-XX*
*Replaced by: agents/gsd-researcher.md*

---

[existing content follows]
```

Keep full content below the notice for reference.
  </action>
  <verify>
```bash
head -20 get-shit-done/references/research-pitfalls.md
```
Should show DEPRECATED notice with pointer to agent
  </verify>
  <done>research-pitfalls.md has deprecation notice pointing to agent</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] commands/gsd/research-project.md is <200 lines
- [ ] Command spawns 4 parallel gsd-researcher agents
- [ ] workflows/research-project.md has deprecation notice
- [ ] research-pitfalls.md has deprecation notice
- [ ] All deprecation notices point to agents/gsd-researcher.md
</verification>

<success_criteria>
- All tasks completed
- Parallel agent spawning pattern documented
- Main context reduced significantly
- All deprecated files point to new agent location
</success_criteria>

<output>
After completion, create `.planning/phases/14-dedicated-researcher-agent/14-03-SUMMARY.md`
</output>
